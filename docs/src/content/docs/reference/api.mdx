---
title: Public API
---

import { Card } from '@astrojs/starlight/components';

## Spectrum
```python
class Spectrum:
```
NMR spectrum.

The recommended way of creating Spectrum instances from spectrum files
is by using the `Spectrum.load()` function. This automatically determines
the format of the spectrum and selects the correct SpectrumReader.

Example usage:
```python
spectrum = Spectrum.load('spectrum_file.ucsf')
```
#### ndim
```python
ndim: int
```
Number of dimensions of the spectrum.
#### nuclei
```python
nuclei: tuple[bioshift.core.nucleus.NMRNucleus, ...]
```
The type of nucleus (13C, 1H, etc.) associated with each axis.
#### data_source
```python
data_source: bioshift.core.spectrumdatasource.SpectrumDataSource
```
Object responsible for lazy-loading and parsing spectrum data.
#### transform
```python
transform: bioshift.core.spectrumtransform.SpectrumTransform
```
Object storing the transformation from array coordinate space to chemical shift space.
#### shape
```python
shape: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[~_ScalarT]]
```
Returns:
Shape of the underlying data array.
#### array
```python
array: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[~_ScalarT]]
```

#### load
```python
@classmethod
def load(cls, path: str | os.PathLike) -> Self:
```
Create a spectrum from a path to a spectrum file.
Automatically determines the file format and dispatches the correct spectrum reader.


###### Arguments:
 - **path:**  Path to the spectrum file.



###### Returns:
> Spectrum object

#### add
```python
def add(self, other: Self) -> Self:
```
Return a new spectrum equal to the pointwise sum of two spectra.


###### Arguments:
 - **other:**  The spectrum to add.



###### Returns:
> A new Spectrum whose values are the sum of those of the two previous spectra.


###### Raises:
 - **ValueError:**  If the shapes of the two spectra do not match


#### subtract
```python
def subtract(self, other: Self) -> Self:
```
Return a new spectrum equal to the pointwise difference of two spectra.


###### Arguments:
 - **other:**  The spectrum to subtract.



###### Returns:
> A new Spectrum whose values are the difference of those of the two previous spectra.


###### Raises:
 - **ValueError:**  If the shapes of the two spectra do not match


#### multiply
```python
def multiply(self, other) -> Self:
```
Return a new spectrum equal to the pointwise product of two spectra.


###### Arguments:
 - **other:**  The spectrum to multiply by.



###### Returns:
> A new Spectrum whose values are the product of those of the two previous spectra.


###### Raises:
 - **ValueError:**  If the shapes of the two spectra do not match


#### slice
```python
def slice(self, axis: int, z: float):
```
Take a slice from the spectrum along the specified axis.


###### Arguments:
 - **axis:**  The index of the axis perpendicular to the slice plane.
 - **z:**  The chemical shift of the plane along the specified axis.



###### Returns:
> A new spectrum, with one fewer dimension.

## NMRNucleus
```python
class NMRNucleus(enum.Enum):
```
Enum representing the NMR-active nucleus associated with a particular chemical shift value.
#### HYDROGEN
```python
HYDROGEN = <NMRNucleus.HYDROGEN: '1H'>
```

#### NITROGEN
```python
NITROGEN = <NMRNucleus.NITROGEN: '15N'>
```

#### CARBON
```python
CARBON = <NMRNucleus.CARBON: '13C'>
```

## SpectrumTransform
```python
class SpectrumTransform:
```
Represents a diagonal affine transformation used to map between
coordinates in the raw spectrum array and chemical shift values.
#### ndim
```python
ndim: int
```
Number of dimensions in the spectrum.
#### shape
```python
shape: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[~_ScalarT]]
```
Shape of the underlying data array.
#### bounds
```python
bounds: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[~_ScalarT]]
```
Bounds of the spectrum (in array grid coordinates).
#### scaling
```python
scaling: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[~_ScalarT]]
```
Vector of diagonal components of the affine transformation matrix. 
Components are scaling values along each axis.
#### offset
```python
offset: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[~_ScalarT]]
```
Constant offset vector for the affine transformation.
#### inverse_scaling
```python
inverse_scaling: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[~_ScalarT]]
```
Vector containing the diagonal entries of the affine transformation matrix for
the inverse transform. Used to convert from chemical shifts to grid coords.
#### inverse_offset
```python
inverse_offset: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[~_ScalarT]]
```
Vector offset for the inverse transform.
Used to convert from chemical shifts to grid coords.
#### grid_to_shift
```python
def grid_to_shift(
    self,
    x: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[~_ScalarT]]
) -> numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[~_ScalarT]]:
```
Convert a grid coord to a chemical shift.


###### Arguments:
 - **x:**  Array containing grid coordinates of points in the spectrum.
   Must be broadcastable to (ndim,).



###### Returns:
> Array of corresponding chemical shift values

#### shift_to_grid
```python
def shift_to_grid(self, x) -> numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[~_ScalarT]]:
```
Convert a grid coord to a chemical shift.

###### Arguments:
 - **x:**  Array containing chemical shift coordinates. Must be broadcastable to (ndim,).



###### Returns:
> Array of corresponding grid coordinates.

#### from_reference
```python
@classmethod
def from_reference(
    cls,
    shape: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[~_ScalarT]],
    spectral_width: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[~_ScalarT]],
    spectrometer_frequency: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[~_ScalarT]],
    ref_coord: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[~_ScalarT]],
    ref_shift: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[~_ScalarT]]
) -> Self:
```
Create a SpectrumTransform from spectrum referencing information.
All arguments must be NDArrays with shape `(ndim,)`


###### Arguments:
 - **shape :**  Number of data points along each axis of the spectrum.
 - **spectral_width:**  Difference in chemical shift across the width of the spectrum along each axis,
   measured in Hz.
 - **spectrometer_frequency:**  Frequency of spectrometer along each axis, measured in MHz.
   Required to convert spectral width into ppm.
 - **ref_coord:**  Grid coordinates of a reference point in the spectrum.
 - **ref_shift:**  Chemical shift vector of the point located at the reference coordinate.



###### Returns:
> `SpectrumTransform` object with scaling and offset vectors calculated
> from the reference data.

#### slice
```python
def slice(self, axis: int) -> Self:
```

## Peak
```python
class Peak:
```
Class to store the chemical shift and width of a peak.
#### shift
```python
shift: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[~_ScalarT]]
```

#### width
```python
width: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[~_ScalarT]]
```

## PeakList
```python
class PeakList:
```
Stores an array of shifts and widths to represent a set of peaks.
PeakLists can be iterated over or indexed as if they were a collection of Peak objects.

Usage:
```python
shifts = np.array([
    [0.6, 2.5, 1.6],
    [15.6, 20.1, 8.5]
])
widths = np.array([
        [1.2, 0.8, 1.],
        [2.5, 2.8, 2.9]
])

peaklist = PeakList(shifts, widths)

print(len(peaklist))
# output: 2

print(peak[0])
# output:
#   Peak(
#       shift=array([0.6, 2.5, 1.6]),
#       width=array([1.2, 0.8, 1. ])
#   )

for peak in peaklist:
    print(peak)

# output:
#   Peak(
#       shift=array([0.6, 2.5, 1.6]),
#       width=array([1.2, 0.8, 1. ])
#   )
#   Peak(
#       shift=array([15.6, 20.1,  8.5]),
#       width=array([2.5, 2.8, 2.9])
#   )
```
#### shifts
```python
shifts: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[~_ScalarT]]
```

#### widths
```python
widths: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[~_ScalarT]] | None
```

#### write_csv
```python
def write_csv(self, path: str | os.PathLike):
```
Save the peak list to a CSV file at the given path.


###### Arguments:
 - **path:**  Path to the destination file.


#### from_csv
```python
def from_csv(path) -> Self:
```
Read a peak list from a CSV file.


###### Returns:
> PeakList object.

